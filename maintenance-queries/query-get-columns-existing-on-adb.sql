
DECLARE @MainTableName VARCHAR(255);
DECLARE @MainTableId INT;
DECLARE @MainTableTypeId INT;

SET @MainTableName = 'OPS_MAIN'
SELECT @MainTableTypeId = Table_TYP_ID FROM SSDL.SPEND_DCC_TABLE_TYP_MST where Table_TYP_code = 101
SELECT @MainTableId = TableId FROM SSDL.SPEND_SSDL_TABLE WHERE TableTypeID = @MainTableTypeId AND TableName = @MainTableName;

select B.DisplayColumnName
from ssdl.SPEND_SSDL_TableSchema B
WHERE B.TableId =@MainTableId AND b.ColumnName IN (
    'PROFIT_CENTER_NAME', 
'PROFIT_CENTER_HIERARCHY_2', 
'PROFIT_CENTER_HIERARCHY_3', 
'PROFIT_CENTER_HIERARCHY_4', 
'PROFIT_CENTER_HIERARCHY_5', 
'GEP_UP_STATUS_FLAG', 
'GEP_CF_STATUS_FLAG', 
'GEP_VNE_STATUS_FLAG', 
'BUSINESS_UNIT_CODE', 
'BUSINESS_UNIT_DESC', 
'GEP_FISCAL_YEAR', 
'GEP_FISCAL_QTR', 
'GEP_FISCAL_MONTH', 
'INVOICE_DOCUMENT_TYPE', 
'INVOICE_POSTING_KEY', 
'PO_LINE_AMOUNT_CURRENCY', 
'PO_UNIT_PRICE_LOCAL', 
'PO_DESCRIPTION_1', 
'PO_BUYER_CODE', 
'PO_BUYER_NAME', 
'PLANT_CITY', 
'SUPPLIER_NUMBER', 
'PAYMENT_TERM_CODE', 
'PAYMENT_TERM_DESCRIPTION', 
'GL_ACCOUNT_CODE', 
'CUSTOM_FIELD_23', 
'CUSTOM_FIELD_24', 
'CUSTOM_FIELD_25', 
'CUSTOM_FIELD_26', 
'CUSTOM_FIELD_213', 
'INVOICE_LINE_AMOUNT_CURRENCY', 
'INVOICE_DEBIT_CREDIT_INDICATOR', 
'INVOICE_LINE_DESCRIPTION', 
'GEP_NORM_SPEND_USD', 
'CUSTOM_FIELD_30', 
'CUSTOM_FIELD_31', 
'CUSTOM_FIELD_32', 
'CUSTOM_FIELD_33', 
'CUSTOM_FIELD_34', 
'CUSTOM_FIELD_8', 
'CUSTOM_FIELD_10', 
'CUSTOM_FIELD_19', 
'CUSTOM_FIELD_20', 
'CUSTOM_FIELD_21', 
'CUSTOM_FIELD_2', 
'CUSTOM_FIELD_11', 
'CUSTOM_FIELD_12', 
'CUSTOM_FIELD_13', 
'CUSTOM_FIELD_14', 
'INVOICE_DOCUMENT_NUMBER', 
'INVOICE_LINE_NUMBER', 
'INVOICE_POSTING_DATE', 
'INVOICE_LINE_AMOUNT_LOCAL', 
'PO_PURCHASING_GROUP_CODE', 
'PO_PURCHASING_ORG_CODE', 
'SOURCESYSTEM_1', 
'MERCHANT_CATEGORY_CODE', 
'GEP_JOB_ID', 
'IS_EXCLUDE', 
'GEP_EXCLUDE', 
'GEP_JOB_NAME', 
'CREATED_DATE', 
'PROFIT_CENTER_HIERARCHY_6', 
'SOURCEFILENAME', 
'CUSTOM_FIELD_1', 
'CUSTOM_FIELD_3', 
'CUSTOM_FIELD_211', 
'CUSTOM_FIELD_212', 
'GEP_EXCLUSION_CRITERIA', 
'SUPPLIER_NAME', 
'MODIFIED_DATE', 
'AUDIT_COLUMN', 
'DATALAKE_MIGRATION_DATE', 
'SOURCETABLE_NAME', 
'PO_NUMBER', 
'PO_LINE_NUMBER', 
'GEP_NORM_SOURCESYSTEM_1', 
'PROFIT_CENTER_CODE', 
'SUPPLIER_ADDRESS', 
'SUPPLIER_CITY', 
'SUPPLIER_COUNTRY', 
'PO_DOCUMENT_TYPE', 
'CUSTOM_FIELD_22', 
'CUSTOM_FIELD_27', 
'CUSTOM_FIELD_28', 
'CUSTOM_FIELD_29', 
'CUSTOM_FIELD_15', 
'CUSTOM_FIELD_16', 
'CUSTOM_FIELD_17', 
'CUSTOM_FIELD_18', 
'BUSINESS_GROUP_DESC', 
'COMPANY_CODE', 
'COMPANY_NAME', 
'COMPANY_COUNTRY', 
'CUSTOM_FIELD_4', 
'CUSTOM_FIELD_5', 
'CUSTOM_FIELD_6', 
'CUSTOM_FIELD_7', 
'GEP_DATAID', 
'UNIQUEID', 
'SOURCE_INDEX_ID', 
'GEP_RULE_ID', 
'GEP_NORM_DATE', 
'GEP_YEAR', 
'GEP_QTR', 
'GEP_MONTH'
)
AND B.ColumnName NOT IN (
'IMPORTEXPORTUID1', 
'IMPORTEXPORTUID2', 
'IMPORTEXPORTUID3', 
'IMPORTEXPORTUID4', 
'IMPORTEXPORTUID5', 
'IMPORTEXPORTUID6', 
'IMPORTEXPORTUID7', 
'IMPORTEXPORTUID8', 
'IMPORTEXPORTUID9', 
'IMPORTEXPORTUID10',
'IS_EXCLUDE',
'SOURCE_INDEX_ID',
'SOURCETABLE_NAME',
'AUDIT_COLUMN',
'DATALAKE_MIGRATION_DATE'
)